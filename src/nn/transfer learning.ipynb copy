{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [],
   "source": [
    "from keras import applications\n",
    "from keras.preprocessing.image import ImageDataGenerator\n",
    "from keras import optimizers\n",
    "from keras.models import Sequential\n",
    "from keras.layers import Dropout, Flatten, Dense\n",
    "import os\n",
    "import os, sklearn, pandas, numpy as np, random\n",
    "from sklearn import svm\n",
    "import skimage, skimage.io, skimage.filters\n",
    "import matplotlib.pyplot as plt\n",
    "from keras.callbacks import TensorBoard\n",
    "from sklearn.utils import shuffle\n",
    "import imp\n",
    "import io\n",
    "\n",
    "# from pcanet import PCANet\n",
    "\n",
    "%matplotlib inline"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'/Users/Tristan/Downloads/dog-breed-identification/src'"
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# set cwd back to default\n",
    "os.chdir('../')\n",
    "os.getcwd()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      " Dataset :: namedtuple(\n",
      "    ['train' = ['img_name']\n",
      "    , 'test' = ['img_name']\n",
      "    , 'validation' = ['img_name']\n",
      "    , 'labels' = pandas.df('img_name','label')\n",
      "    , 'dict_index_to_label' = dict to convert label_index -> label_name\n",
      "    , 'dict_label_to_index'= dict to convert label_name -> label_index\n",
      "    \n"
     ]
    }
   ],
   "source": [
    "# custom scripts\n",
    "import config # params, constants\n",
    "import data, models # functions that mutate outr data\n",
    "# from utils import utils, plot # custom functions, in local environment"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "import data # src/data.py\n",
    "dataset = data.init_dataset()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Select the amount of classes that will be used"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['paper', 'glass', 'plastic', 'metal', 'cardboard']"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# pick the n classes with the most occuring instances\n",
    "amt = 5\n",
    "classes = data.top_classes(dataset.labels, amt)\n",
    "classes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "paper\n",
      "glass\n",
      "plastic\n",
      "metal\n",
      "cardboard\n",
      "paper\n",
      "glass\n",
      "plastic\n",
      "metal\n",
      "cardboard\n",
      "paper\n",
      "glass\n",
      "plastic\n",
      "metal\n",
      "cardboard\n"
     ]
    }
   ],
   "source": [
    "def extract_topx_classes(classes, train_or_test):\n",
    "    name_list = []\n",
    "    n_per_class = []\n",
    "    tail = '.jpg'\n",
    "    for cls in classes:\n",
    "        print(cls)\n",
    "        names = data.items_with_label(dataset.labels, cls)\n",
    "        if train_or_test == 'train':\n",
    "            train_names = [f for f in names if (f) in dataset.train]\n",
    "        if train_or_test == 'test':\n",
    "            train_names = [f for f in names if (f) in dataset.test]\n",
    "        if train_or_test == 'validation':\n",
    "            train_names = [f for f in names if (f) in dataset.validation]\n",
    "        name_list.append(train_names)\n",
    "        n_per_class.append(len(train_names))\n",
    "\n",
    "    n = min(n_per_class)\n",
    "    # (optional) reduce n to check whether the model can rember its input\n",
    "#     reduced_n = 50\n",
    "#     if n > reduced_n:    n = reduced_n\n",
    "    x = []\n",
    "    for ls in name_list:\n",
    "        for name in ls:\n",
    "            x.append(name)\n",
    "    random.shuffle(x)\n",
    "    return x\n",
    "\n",
    "x_train = extract_topx_classes(classes, 'train')\n",
    "x_test = extract_topx_classes(classes, 'test')\n",
    "x_validation = extract_topx_classes(classes, 'validation')\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "print(x_train[0].shape)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Load and convert images"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn import decomposition\n",
    "nsamples, nx, ny = x_train[0].shape\n",
    "d2_x_train = x_train.reshape((nsamples,nx*ny))\n",
    "pca = decomposition.PCA(n_components=3)\n",
    "pca.fit(d2_x_train)\n",
    "X = pca.transform(d2_x_train)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Training data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "('extract all data:', 1940)\n",
      "metal\n",
      "metal\n",
      "metal\n",
      "metal\n",
      "paper\n",
      "cardboard\n",
      "glass\n",
      "cardboard\n",
      "cardboard\n",
      "cardboard\n",
      "cardboard\n",
      "metal\n",
      "plastic\n",
      "paper\n",
      "glass\n",
      "cardboard\n",
      "cardboard\n",
      "paper\n",
      "glass\n",
      "glass\n",
      "metal\n",
      "paper\n",
      "plastic\n",
      "plastic\n",
      "glass\n",
      "glass\n",
      "glass\n",
      "paper\n",
      "cardboard\n",
      "glass\n",
      "paper\n",
      "glass\n",
      "metal\n",
      "plastic\n",
      "glass\n",
      "paper\n",
      "metal\n",
      "plastic\n",
      "paper\n",
      "plastic\n",
      "paper\n",
      "metal\n",
      "metal\n",
      "metal\n",
      "plastic\n",
      "paper\n",
      "cardboard\n",
      "cardboard\n",
      "paper\n",
      "metal\n",
      "paper\n",
      "metal\n",
      "glass\n",
      "glass\n",
      "glass\n",
      "glass\n",
      "paper\n",
      "metal\n",
      "metal\n",
      "glass\n",
      "paper\n",
      "glass\n",
      "metal\n",
      "cardboard\n",
      "glass\n",
      "paper\n",
      "metal\n",
      "metal\n",
      "plastic\n",
      "glass\n",
      "paper\n",
      "plastic\n",
      "glass\n",
      "cardboard\n",
      "metal\n",
      "glass\n",
      "plastic\n",
      "paper\n",
      "paper\n",
      "glass\n",
      "glass\n",
      "paper\n",
      "glass\n",
      "plastic\n",
      "paper\n",
      "cardboard\n",
      "plastic\n",
      "paper\n",
      "glass\n",
      "glass\n",
      "paper\n",
      "paper\n",
      "metal\n",
      "paper\n",
      "cardboard\n",
      "plastic\n",
      "cardboard\n",
      "paper\n",
      "glass\n",
      "glass\n",
      "cardboard\n",
      "cardboard\n",
      "glass\n",
      "metal\n",
      "paper\n",
      "paper\n",
      "cardboard\n",
      "paper\n",
      "glass\n",
      "paper\n",
      "plastic\n",
      "glass\n",
      "plastic\n",
      "glass\n",
      "plastic\n",
      "plastic\n",
      "paper\n",
      "paper\n",
      "cardboard\n",
      "glass\n",
      "metal\n",
      "plastic\n",
      "cardboard\n",
      "glass\n",
      "paper\n",
      "paper\n",
      "plastic\n",
      "glass\n",
      "cardboard\n",
      "plastic\n",
      "glass\n",
      "cardboard\n",
      "plastic\n",
      "glass\n",
      "glass\n",
      "paper\n",
      "cardboard\n",
      "glass\n",
      "glass\n",
      "plastic\n",
      "paper\n",
      "plastic\n",
      "cardboard\n",
      "glass\n",
      "paper\n",
      "metal\n",
      "paper\n",
      "glass\n",
      "glass\n",
      "paper\n",
      "paper\n",
      "glass\n",
      "plastic\n",
      "plastic\n",
      "cardboard\n",
      "plastic\n",
      "cardboard\n",
      "plastic\n",
      "plastic\n",
      "paper\n",
      "paper\n",
      "glass\n",
      "paper\n",
      "cardboard\n",
      "glass\n",
      "metal\n",
      "paper\n",
      "glass\n",
      "cardboard\n",
      "paper\n",
      "cardboard\n",
      "metal\n",
      "metal\n",
      "glass\n",
      "metal\n",
      "paper\n",
      "paper\n",
      "cardboard\n",
      "cardboard\n",
      "glass\n",
      "metal\n",
      "plastic\n",
      "glass\n",
      "plastic\n",
      "plastic\n",
      "paper\n",
      "cardboard\n",
      "glass\n",
      "glass\n",
      "cardboard\n",
      "cardboard\n",
      "cardboard\n",
      "plastic\n",
      "metal\n",
      "paper\n",
      "cardboard\n",
      "cardboard\n",
      "metal\n",
      "cardboard\n",
      "cardboard\n",
      "metal\n",
      "glass\n",
      "cardboard\n",
      "plastic\n",
      "cardboard\n",
      "paper\n",
      "glass\n",
      "plastic\n",
      "paper\n",
      "metal\n",
      "paper\n",
      "paper\n",
      "glass\n",
      "metal\n",
      "glass\n",
      "plastic\n",
      "cardboard\n",
      "metal\n",
      "paper\n",
      "paper\n",
      "cardboard\n",
      "cardboard\n",
      "glass\n",
      "metal\n",
      "plastic\n",
      "paper\n",
      "glass\n",
      "glass\n",
      "cardboard\n",
      "glass\n",
      "plastic\n",
      "plastic\n",
      "metal\n",
      "glass\n",
      "paper\n",
      "glass\n",
      "paper\n",
      "paper\n",
      "paper\n",
      "metal\n",
      "plastic\n",
      "metal\n",
      "plastic\n",
      "glass\n",
      "paper\n",
      "plastic\n",
      "metal\n",
      "glass\n",
      "plastic\n",
      "cardboard\n",
      "metal\n",
      "metal\n",
      "paper\n",
      "cardboard\n",
      "glass\n",
      "metal\n",
      "glass\n",
      "paper\n",
      "plastic\n",
      "glass\n",
      "cardboard\n",
      "paper\n",
      "cardboard\n",
      "plastic\n",
      "cardboard\n",
      "cardboard\n",
      "cardboard\n",
      "glass\n",
      "plastic\n",
      "paper\n",
      "plastic\n",
      "plastic\n",
      "cardboard\n",
      "plastic\n",
      "plastic\n",
      "plastic\n",
      "plastic\n",
      "plastic\n",
      "plastic\n",
      "paper\n",
      "plastic\n",
      "paper\n",
      "paper\n",
      "plastic\n",
      "metal\n",
      "glass\n",
      "glass\n",
      "cardboard\n",
      "paper\n",
      "metal\n",
      "cardboard\n",
      "cardboard\n",
      "paper\n",
      "cardboard\n",
      "paper\n",
      "plastic\n",
      "paper\n",
      "plastic\n",
      "paper\n",
      "glass\n",
      "cardboard\n",
      "glass\n",
      "glass\n",
      "plastic\n",
      "paper\n",
      "glass\n",
      "plastic\n",
      "paper\n",
      "plastic\n",
      "metal\n",
      "paper\n",
      "plastic\n",
      "paper\n",
      "paper\n",
      "metal\n",
      "plastic\n",
      "paper\n",
      "cardboard\n",
      "cardboard\n",
      "metal\n",
      "plastic\n",
      "cardboard\n",
      "glass\n",
      "paper\n",
      "glass\n",
      "plastic\n",
      "cardboard\n",
      "paper\n",
      "cardboard\n",
      "metal\n",
      "plastic\n",
      "glass\n",
      "glass\n",
      "paper\n",
      "paper\n",
      "metal\n",
      "metal\n",
      "plastic\n",
      "glass\n",
      "paper\n",
      "metal\n",
      "metal\n",
      "paper\n",
      "metal\n",
      "glass\n",
      "metal\n",
      "glass\n",
      "paper\n",
      "plastic\n",
      "metal\n",
      "paper\n",
      "plastic\n",
      "metal\n",
      "cardboard\n",
      "metal\n",
      "metal\n",
      "metal\n",
      "paper\n",
      "paper\n",
      "metal\n",
      "plastic\n",
      "cardboard\n",
      "metal\n",
      "paper\n",
      "cardboard\n",
      "plastic\n",
      "plastic\n",
      "metal\n",
      "plastic\n",
      "paper\n",
      "glass\n",
      "glass\n",
      "paper\n",
      "cardboard\n",
      "paper\n",
      "glass\n",
      "metal\n",
      "glass\n",
      "plastic\n",
      "cardboard\n",
      "paper\n",
      "glass\n",
      "metal\n",
      "glass\n",
      "cardboard\n",
      "cardboard\n",
      "plastic\n",
      "plastic\n",
      "paper\n",
      "glass\n",
      "paper\n",
      "metal\n",
      "paper\n",
      "cardboard\n",
      "paper\n",
      "plastic\n",
      "glass\n",
      "plastic\n",
      "plastic\n",
      "glass\n",
      "plastic\n",
      "paper\n",
      "plastic\n",
      "plastic\n",
      "glass\n",
      "metal\n",
      "plastic\n",
      "glass\n",
      "paper\n",
      "cardboard\n",
      "metal\n",
      "metal\n",
      "metal\n",
      "metal\n",
      "plastic\n",
      "metal\n",
      "paper\n",
      "paper\n",
      "plastic\n",
      "plastic\n",
      "plastic\n",
      "metal\n",
      "plastic\n",
      "metal\n",
      "paper\n",
      "glass\n",
      "plastic\n",
      "plastic\n",
      "metal\n",
      "cardboard\n",
      "plastic\n",
      "glass\n",
      "plastic\n",
      "cardboard\n",
      "cardboard\n",
      "cardboard\n",
      "glass\n",
      "plastic\n",
      "glass\n",
      "metal\n",
      "plastic\n",
      "paper\n",
      "metal\n",
      "glass\n",
      "plastic\n",
      "plastic\n",
      "paper\n",
      "cardboard\n",
      "paper\n",
      "cardboard\n",
      "metal\n",
      "paper\n",
      "cardboard\n",
      "glass\n",
      "plastic\n",
      "paper\n",
      "paper\n",
      "plastic\n",
      "cardboard\n",
      "cardboard\n",
      "paper\n",
      "cardboard\n",
      "glass\n",
      "metal\n",
      "paper\n",
      "metal\n",
      "plastic\n",
      "glass\n",
      "plastic\n",
      "paper\n",
      "cardboard\n",
      "plastic\n",
      "metal\n",
      "metal\n",
      "plastic\n",
      "cardboard\n",
      "metal\n",
      "paper\n",
      "paper\n",
      "glass\n",
      "cardboard\n",
      "paper\n",
      "glass\n",
      "cardboard\n",
      "cardboard\n",
      "metal\n",
      "paper\n",
      "plastic\n",
      "glass\n",
      "paper\n",
      "plastic\n",
      "glass\n",
      "plastic\n",
      "glass\n",
      "cardboard\n",
      "glass\n",
      "plastic\n",
      "plastic\n",
      "glass\n",
      "cardboard\n",
      "plastic\n",
      "cardboard\n",
      "plastic\n",
      "metal\n",
      "glass\n",
      "plastic\n",
      "metal\n",
      "paper\n",
      "cardboard\n",
      "plastic\n",
      "plastic\n",
      "plastic\n",
      "plastic\n",
      "glass\n",
      "cardboard\n",
      "metal\n",
      "paper\n",
      "glass\n",
      "plastic\n",
      "glass\n",
      "glass\n",
      "metal\n",
      "paper\n",
      "metal\n",
      "metal\n",
      "paper\n",
      "paper\n",
      "glass\n",
      "glass\n",
      "cardboard\n",
      "glass\n",
      "plastic\n",
      "metal\n",
      "cardboard\n",
      "glass\n",
      "paper\n",
      "glass\n",
      "cardboard\n",
      "cardboard\n",
      "cardboard\n",
      "glass\n",
      "glass\n",
      "cardboard\n",
      "glass\n",
      "glass\n",
      "metal\n",
      "paper\n",
      "paper\n",
      "paper\n",
      "paper\n",
      "paper\n",
      "paper\n",
      "plastic\n",
      "paper\n",
      "plastic\n",
      "glass\n",
      "plastic\n",
      "plastic\n",
      "cardboard\n",
      "metal\n",
      "paper\n",
      "glass\n",
      "glass\n",
      "plastic\n",
      "paper\n",
      "cardboard\n",
      "metal\n",
      "paper\n",
      "plastic\n",
      "metal\n",
      "metal\n",
      "glass\n",
      "plastic\n",
      "cardboard\n",
      "glass\n",
      "glass\n",
      "metal\n",
      "cardboard\n",
      "glass\n",
      "plastic\n",
      "plastic\n",
      "cardboard\n",
      "paper\n",
      "glass\n",
      "cardboard\n",
      "cardboard\n",
      "cardboard\n",
      "glass\n",
      "plastic\n",
      "glass\n",
      "cardboard\n",
      "metal\n",
      "plastic\n",
      "paper\n",
      "metal\n",
      "metal\n",
      "paper\n",
      "plastic\n",
      "cardboard\n",
      "glass\n",
      "metal\n",
      "plastic\n",
      "paper\n",
      "plastic\n",
      "plastic\n",
      "metal\n",
      "metal\n",
      "plastic\n",
      "paper\n",
      "metal\n",
      "cardboard\n",
      "glass\n",
      "metal\n",
      "glass\n",
      "metal\n",
      "paper\n",
      "paper\n",
      "glass\n",
      "plastic\n",
      "glass\n",
      "glass\n",
      "cardboard\n",
      "glass\n",
      "paper\n",
      "cardboard\n",
      "glass\n",
      "paper\n",
      "glass\n",
      "paper\n",
      "glass\n",
      "glass\n",
      "metal\n",
      "glass\n",
      "metal\n",
      "plastic\n",
      "paper\n",
      "cardboard\n",
      "metal\n",
      "glass\n",
      "paper\n",
      "cardboard\n",
      "plastic\n",
      "cardboard\n",
      "paper\n",
      "metal\n",
      "glass\n",
      "cardboard\n",
      "metal\n",
      "plastic\n",
      "cardboard\n",
      "cardboard\n",
      "plastic\n",
      "plastic\n",
      "metal\n",
      "plastic\n",
      "plastic\n",
      "plastic\n",
      "cardboard\n",
      "cardboard\n",
      "paper\n",
      "glass\n",
      "paper\n",
      "cardboard\n",
      "plastic\n",
      "metal\n",
      "metal\n",
      "paper\n",
      "metal\n",
      "glass\n",
      "plastic\n",
      "metal\n",
      "paper\n",
      "metal\n",
      "cardboard\n",
      "paper\n",
      "paper\n",
      "glass\n",
      "glass\n",
      "cardboard\n",
      "paper\n",
      "metal\n",
      "cardboard\n",
      "plastic\n",
      "plastic\n",
      "paper\n",
      "cardboard\n",
      "glass\n",
      "paper\n",
      "glass\n",
      "glass\n",
      "paper\n",
      "cardboard\n",
      "metal\n",
      "paper\n",
      "plastic\n",
      "cardboard\n",
      "cardboard\n",
      "glass\n",
      "metal\n",
      "paper\n",
      "cardboard\n",
      "paper\n",
      "glass\n",
      "plastic\n",
      "paper\n",
      "cardboard\n",
      "cardboard\n",
      "glass\n",
      "plastic\n",
      "plastic\n",
      "plastic\n",
      "paper\n",
      "plastic\n",
      "paper\n",
      "glass\n",
      "glass\n",
      "metal\n",
      "metal\n",
      "plastic\n",
      "paper\n",
      "glass\n",
      "metal\n",
      "glass\n",
      "glass\n",
      "paper\n",
      "glass\n",
      "paper\n",
      "cardboard\n",
      "metal\n",
      "cardboard\n",
      "paper\n",
      "plastic\n",
      "cardboard\n",
      "paper\n",
      "metal\n",
      "metal\n",
      "cardboard\n",
      "paper\n",
      "paper\n",
      "glass\n",
      "paper\n",
      "cardboard\n",
      "metal\n",
      "paper\n",
      "paper\n",
      "paper\n",
      "plastic\n",
      "paper\n",
      "paper\n",
      "glass\n",
      "metal\n",
      "cardboard\n",
      "cardboard\n",
      "cardboard\n",
      "cardboard\n",
      "plastic\n",
      "plastic\n",
      "glass\n",
      "cardboard\n",
      "cardboard\n",
      "glass\n",
      "paper\n",
      "plastic\n",
      "plastic\n",
      "cardboard\n",
      "glass\n",
      "plastic\n",
      "paper\n",
      "plastic\n",
      "glass\n",
      "plastic\n",
      "glass\n",
      "plastic\n",
      "paper\n",
      "glass\n",
      "glass\n",
      "metal\n",
      "metal\n",
      "plastic\n",
      "paper\n",
      "paper\n",
      "glass\n",
      "paper\n",
      "paper\n",
      "paper\n",
      "metal\n",
      "glass\n",
      "glass\n",
      "glass\n",
      "paper\n",
      "paper\n",
      "paper\n",
      "plastic\n",
      "cardboard\n",
      "plastic\n",
      "cardboard\n",
      "cardboard\n",
      "cardboard\n",
      "glass\n",
      "plastic\n",
      "paper\n",
      "paper\n",
      "glass\n",
      "glass\n",
      "plastic\n",
      "paper\n",
      "plastic\n",
      "cardboard\n",
      "metal\n",
      "plastic\n",
      "plastic\n",
      "glass\n",
      "cardboard\n",
      "glass\n",
      "glass\n",
      "glass\n",
      "glass\n",
      "paper\n",
      "cardboard\n",
      "metal\n",
      "plastic\n",
      "paper\n",
      "paper\n",
      "glass\n",
      "plastic\n",
      "glass\n",
      "paper\n",
      "paper\n",
      "glass\n",
      "plastic\n",
      "metal\n",
      "cardboard\n",
      "paper\n",
      "paper\n",
      "paper\n",
      "paper\n",
      "metal\n",
      "plastic\n",
      "metal\n",
      "plastic\n",
      "metal\n",
      "cardboard\n",
      "plastic\n",
      "glass\n",
      "glass\n",
      "glass\n",
      "paper\n",
      "paper\n",
      "metal\n",
      "plastic\n",
      "cardboard\n",
      "metal\n",
      "paper\n",
      "paper\n",
      "plastic\n",
      "cardboard\n",
      "paper\n",
      "cardboard\n",
      "paper\n",
      "metal\n",
      "metal\n",
      "paper\n",
      "metal\n",
      "glass\n",
      "metal\n",
      "glass\n",
      "metal\n",
      "metal\n",
      "metal\n",
      "paper\n",
      "metal\n",
      "plastic\n",
      "paper\n",
      "paper\n",
      "paper\n",
      "cardboard\n",
      "paper\n",
      "plastic\n",
      "glass\n",
      "cardboard\n",
      "cardboard\n",
      "paper\n",
      "cardboard\n",
      "cardboard\n",
      "metal\n",
      "cardboard\n",
      "glass\n",
      "paper\n",
      "cardboard\n",
      "metal\n",
      "glass\n",
      "metal\n",
      "plastic\n",
      "glass\n",
      "glass\n",
      "glass\n",
      "plastic\n",
      "plastic\n",
      "plastic\n",
      "metal\n",
      "paper\n",
      "plastic\n",
      "cardboard\n",
      "glass\n",
      "cardboard\n",
      "plastic\n",
      "metal\n",
      "metal\n",
      "cardboard\n",
      "plastic\n",
      "glass\n",
      "metal\n",
      "plastic\n",
      "glass\n",
      "paper\n",
      "paper\n",
      "paper\n",
      "paper\n",
      "paper\n",
      "paper\n",
      "glass\n",
      "plastic\n",
      "metal\n",
      "paper\n",
      "metal\n",
      "glass\n",
      "plastic\n",
      "plastic\n",
      "glass\n",
      "cardboard\n",
      "glass\n",
      "plastic\n",
      "metal\n",
      "paper\n",
      "plastic\n",
      "plastic\n",
      "plastic\n",
      "metal\n",
      "paper\n",
      "plastic\n",
      "metal\n",
      "plastic\n",
      "paper\n",
      "cardboard\n",
      "glass\n",
      "metal\n",
      "glass\n",
      "paper\n",
      "plastic\n",
      "plastic\n",
      "paper\n",
      "glass\n",
      "plastic\n",
      "cardboard\n",
      "glass\n",
      "paper\n",
      "paper\n",
      "paper\n",
      "paper\n",
      "paper\n",
      "metal\n",
      "cardboard\n",
      "glass\n",
      "plastic\n",
      "glass\n",
      "plastic\n",
      "cardboard\n",
      "metal\n",
      "paper\n",
      "cardboard\n",
      "paper\n",
      "paper\n",
      "metal\n",
      "glass\n",
      "glass\n",
      "paper\n",
      "metal\n",
      "paper\n",
      "metal\n",
      "paper\n",
      "paper\n",
      "paper\n",
      "cardboard\n",
      "paper\n",
      "paper\n",
      "paper\n",
      "cardboard\n",
      "metal\n",
      "metal\n",
      "paper\n",
      "metal\n",
      "metal\n",
      "paper\n",
      "paper\n",
      "paper\n",
      "metal\n",
      "plastic\n",
      "cardboard\n",
      "cardboard\n",
      "glass\n",
      "glass\n",
      "cardboard\n",
      "glass\n",
      "metal\n",
      "cardboard\n",
      "glass\n",
      "plastic\n",
      "paper\n",
      "plastic\n",
      "glass\n",
      "metal\n",
      "cardboard\n",
      "glass\n",
      "glass\n",
      "paper\n",
      "cardboard\n",
      "paper\n",
      "paper\n",
      "metal\n",
      "cardboard\n",
      "cardboard\n",
      "metal\n",
      "paper\n",
      "metal\n",
      "cardboard\n",
      "plastic\n",
      "cardboard\n",
      "glass\n",
      "glass\n",
      "paper\n",
      "glass\n",
      "metal\n",
      "metal\n",
      "glass\n",
      "plastic\n",
      "cardboard\n",
      "plastic\n",
      "metal\n",
      "cardboard\n",
      "plastic\n",
      "cardboard\n",
      "paper\n",
      "glass\n",
      "glass\n",
      "plastic\n",
      "paper\n",
      "plastic\n",
      "glass\n",
      "cardboard\n",
      "paper\n",
      "cardboard\n",
      "glass\n",
      "plastic\n",
      "paper\n",
      "metal\n",
      "plastic\n",
      "glass\n",
      "glass\n",
      "glass\n",
      "paper\n",
      "cardboard\n",
      "paper\n",
      "glass\n",
      "cardboard\n",
      "glass\n",
      "glass\n",
      "glass\n",
      "cardboard\n",
      "glass\n",
      "cardboard\n",
      "metal\n",
      "cardboard\n",
      "metal\n",
      "paper\n",
      "paper\n",
      "plastic\n",
      "plastic\n",
      "glass\n",
      "paper\n",
      "metal\n",
      "paper\n",
      "glass\n",
      "paper\n",
      "glass\n",
      "paper\n",
      "metal\n",
      "glass\n",
      "plastic\n",
      "glass\n",
      "paper\n",
      "plastic\n",
      "metal\n",
      "paper\n",
      "glass\n",
      "cardboard\n",
      "metal\n",
      "metal\n",
      "metal\n",
      "metal\n",
      "metal\n",
      "metal\n",
      "plastic\n",
      "plastic\n",
      "paper\n",
      "plastic\n",
      "metal\n",
      "paper\n",
      "metal\n",
      "glass\n",
      "paper\n",
      "plastic\n",
      "cardboard\n",
      "plastic\n",
      "plastic\n",
      "cardboard\n",
      "paper\n",
      "cardboard\n",
      "metal\n",
      "glass\n",
      "glass\n",
      "paper\n",
      "paper\n",
      "paper\n",
      "metal\n",
      "paper\n",
      "paper\n",
      "paper\n",
      "plastic\n",
      "paper\n",
      "paper\n",
      "glass\n",
      "metal\n",
      "metal\n",
      "metal\n",
      "paper\n",
      "paper\n",
      "glass\n",
      "glass\n",
      "paper\n",
      "cardboard\n",
      "metal\n",
      "paper\n",
      "metal\n",
      "cardboard\n",
      "plastic\n",
      "plastic\n",
      "paper\n",
      "paper\n",
      "plastic\n",
      "paper\n",
      "glass\n",
      "paper\n",
      "metal\n",
      "glass\n",
      "plastic\n",
      "metal\n",
      "metal\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "glass\n",
      "metal\n",
      "plastic\n",
      "plastic\n",
      "plastic\n",
      "paper\n",
      "plastic\n",
      "paper\n",
      "cardboard\n",
      "plastic\n",
      "plastic\n",
      "metal\n",
      "paper\n",
      "metal\n",
      "glass\n",
      "plastic\n",
      "metal\n",
      "paper\n",
      "plastic\n",
      "paper\n",
      "paper\n",
      "metal\n",
      "paper\n",
      "paper\n",
      "plastic\n",
      "plastic\n",
      "paper\n",
      "plastic\n",
      "glass\n",
      "paper\n",
      "cardboard\n",
      "paper\n",
      "paper\n",
      "paper\n",
      "paper\n",
      "metal\n",
      "paper\n",
      "glass\n",
      "glass\n",
      "paper\n",
      "plastic\n",
      "glass\n",
      "metal\n",
      "plastic\n",
      "plastic\n",
      "plastic\n",
      "paper\n",
      "metal\n",
      "glass\n",
      "paper\n",
      "paper\n",
      "paper\n",
      "paper\n",
      "plastic\n",
      "glass\n",
      "plastic\n",
      "glass\n",
      "glass\n",
      "glass\n",
      "plastic\n",
      "plastic\n",
      "plastic\n",
      "paper\n",
      "glass\n",
      "paper\n",
      "metal\n",
      "paper\n",
      "paper\n",
      "glass\n",
      "cardboard\n",
      "cardboard\n",
      "paper\n",
      "plastic\n",
      "cardboard\n",
      "paper\n",
      "paper\n",
      "metal\n",
      "paper\n",
      "plastic\n",
      "plastic\n",
      "plastic\n",
      "paper\n",
      "metal\n",
      "paper\n",
      "glass\n",
      "paper\n",
      "paper\n",
      "glass\n",
      "glass\n",
      "paper\n",
      "plastic\n",
      "glass\n",
      "cardboard\n",
      "glass\n",
      "cardboard\n",
      "metal\n",
      "paper\n",
      "plastic\n",
      "metal\n",
      "glass\n",
      "metal\n",
      "metal\n",
      "glass\n",
      "glass\n",
      "glass\n",
      "plastic\n",
      "metal\n",
      "metal\n",
      "paper\n",
      "glass\n",
      "plastic\n",
      "glass\n",
      "paper\n",
      "paper\n",
      "plastic\n",
      "metal\n",
      "cardboard\n",
      "plastic\n",
      "metal\n",
      "paper\n",
      "cardboard\n",
      "plastic\n",
      "plastic\n",
      "plastic\n",
      "paper\n",
      "paper\n",
      "glass\n",
      "cardboard\n",
      "metal\n",
      "glass\n",
      "cardboard\n",
      "paper\n",
      "glass\n",
      "glass\n",
      "paper\n",
      "glass\n",
      "paper\n",
      "glass\n",
      "plastic\n",
      "glass\n",
      "paper\n",
      "glass\n",
      "plastic\n",
      "cardboard\n",
      "paper\n",
      "glass\n",
      "cardboard\n",
      "plastic\n",
      "plastic\n",
      "metal\n",
      "paper\n",
      "plastic\n",
      "metal\n",
      "cardboard\n",
      "metal\n",
      "plastic\n",
      "cardboard\n",
      "plastic\n",
      "metal\n",
      "metal\n",
      "paper\n",
      "paper\n",
      "cardboard\n",
      "plastic\n",
      "paper\n",
      "glass\n",
      "paper\n",
      "glass\n",
      "paper\n",
      "paper\n",
      "paper\n",
      "metal\n",
      "paper\n",
      "glass\n",
      "metal\n",
      "plastic\n",
      "paper\n",
      "paper\n",
      "cardboard\n",
      "metal\n",
      "metal\n",
      "paper\n",
      "plastic\n",
      "plastic\n",
      "paper\n",
      "cardboard\n",
      "glass\n",
      "cardboard\n",
      "glass\n",
      "plastic\n",
      "paper\n",
      "paper\n",
      "paper\n",
      "metal\n",
      "plastic\n",
      "plastic\n",
      "paper\n",
      "paper\n",
      "cardboard\n",
      "cardboard\n",
      "metal\n",
      "metal\n",
      "cardboard\n",
      "paper\n",
      "plastic\n",
      "cardboard\n",
      "metal\n",
      "plastic\n",
      "plastic\n",
      "plastic\n",
      "cardboard\n",
      "glass\n",
      "cardboard\n",
      "metal\n",
      "paper\n",
      "cardboard\n",
      "cardboard\n",
      "cardboard\n",
      "cardboard\n",
      "plastic\n",
      "paper\n",
      "paper\n",
      "glass\n",
      "metal\n",
      "plastic\n",
      "glass\n",
      "plastic\n",
      "glass\n",
      "paper\n",
      "paper\n",
      "plastic\n",
      "metal\n",
      "plastic\n",
      "paper\n",
      "glass\n",
      "metal\n",
      "paper\n",
      "cardboard\n",
      "plastic\n",
      "plastic\n",
      "plastic\n",
      "paper\n",
      "cardboard\n",
      "plastic\n",
      "glass\n",
      "paper\n",
      "paper\n",
      "paper\n",
      "metal\n",
      "glass\n",
      "paper\n",
      "paper\n",
      "paper\n",
      "metal\n",
      "metal\n",
      "plastic\n",
      "metal\n",
      "plastic\n",
      "metal\n",
      "metal\n",
      "paper\n",
      "plastic\n",
      "metal\n",
      "paper\n",
      "metal\n",
      "glass\n",
      "plastic\n",
      "cardboard\n",
      "glass\n",
      "glass\n",
      "glass\n",
      "plastic\n",
      "cardboard\n",
      "cardboard\n",
      "cardboard\n",
      "paper\n",
      "paper\n",
      "paper\n",
      "cardboard\n",
      "metal\n",
      "glass\n",
      "glass\n",
      "glass\n",
      "paper\n",
      "paper\n",
      "plastic\n",
      "paper\n",
      "cardboard\n",
      "cardboard\n",
      "paper\n",
      "plastic\n",
      "metal\n",
      "cardboard\n",
      "cardboard\n",
      "paper\n",
      "plastic\n",
      "metal\n",
      "cardboard\n",
      "paper\n",
      "cardboard\n",
      "paper\n",
      "paper\n",
      "plastic\n",
      "glass\n",
      "paper\n",
      "cardboard\n",
      "paper\n",
      "glass\n",
      "paper\n",
      "metal\n",
      "plastic\n",
      "metal\n",
      "glass\n",
      "cardboard\n",
      "paper\n",
      "plastic\n",
      "cardboard\n",
      "plastic\n",
      "glass\n",
      "paper\n",
      "glass\n",
      "metal\n",
      "metal\n",
      "plastic\n",
      "cardboard\n",
      "glass\n",
      "plastic\n",
      "metal\n",
      "plastic\n",
      "plastic\n",
      "paper\n",
      "metal\n",
      "metal\n",
      "metal\n",
      "glass\n",
      "cardboard\n",
      "cardboard\n",
      "paper\n",
      "paper\n",
      "glass\n",
      "paper\n",
      "paper\n",
      "plastic\n",
      "plastic\n",
      "paper\n",
      "cardboard\n",
      "cardboard\n",
      "plastic\n",
      "plastic\n",
      "cardboard\n",
      "paper\n",
      "plastic\n",
      "plastic\n",
      "paper\n",
      "plastic\n",
      "paper\n",
      "paper\n",
      "cardboard\n",
      "paper\n",
      "plastic\n",
      "metal\n",
      "plastic\n",
      "metal\n",
      "paper\n",
      "cardboard\n",
      "metal\n",
      "paper\n",
      "paper\n",
      "glass\n",
      "glass\n",
      "glass\n",
      "metal\n",
      "glass\n",
      "metal\n",
      "glass\n",
      "plastic\n",
      "glass\n",
      "paper\n",
      "paper\n",
      "metal\n",
      "glass\n",
      "cardboard\n",
      "glass\n",
      "paper\n",
      "plastic\n",
      "paper\n",
      "glass\n",
      "paper\n",
      "paper\n",
      "cardboard\n",
      "cardboard\n",
      "metal\n",
      "glass\n",
      "metal\n",
      "paper\n",
      "paper\n",
      "cardboard\n",
      "plastic\n",
      "glass\n",
      "glass\n",
      "glass\n",
      "paper\n",
      "paper\n",
      "plastic\n",
      "plastic\n",
      "paper\n",
      "paper\n",
      "glass\n",
      "cardboard\n",
      "metal\n",
      "cardboard\n",
      "plastic\n",
      "plastic\n",
      "glass\n",
      "cardboard\n",
      "cardboard\n",
      "metal\n",
      "cardboard\n",
      "paper\n",
      "glass\n",
      "glass\n",
      "cardboard\n",
      "plastic\n",
      "metal\n",
      "plastic\n",
      "glass\n",
      "metal\n",
      "paper\n",
      "glass\n",
      "glass\n",
      "plastic\n",
      "paper\n",
      "plastic\n",
      "metal\n",
      "plastic\n",
      "paper\n",
      "plastic\n",
      "metal\n",
      "glass\n",
      "plastic\n",
      "paper\n",
      "plastic\n",
      "plastic\n",
      "paper\n",
      "cardboard\n",
      "cardboard\n",
      "metal\n",
      "paper\n",
      "glass\n",
      "paper\n",
      "paper\n",
      "glass\n",
      "glass\n",
      "metal\n",
      "glass\n",
      "paper\n",
      "cardboard\n",
      "paper\n",
      "glass\n",
      "paper\n",
      "metal\n",
      "plastic\n",
      "glass\n",
      "paper\n",
      "glass\n",
      "paper\n",
      "paper\n",
      "plastic\n",
      "glass\n",
      "glass\n",
      "glass\n",
      "glass\n",
      "metal\n",
      "glass\n",
      "plastic\n",
      "glass\n",
      "glass\n",
      "plastic\n",
      "plastic\n",
      "paper\n",
      "glass\n",
      "plastic\n",
      "paper\n",
      "glass\n",
      "paper\n",
      "cardboard\n",
      "plastic\n",
      "glass\n",
      "cardboard\n",
      "cardboard\n",
      "plastic\n",
      "plastic\n",
      "plastic\n",
      "plastic\n",
      "paper\n",
      "metal\n",
      "metal\n",
      "cardboard\n",
      "glass\n",
      "cardboard\n",
      "paper\n",
      "glass\n",
      "plastic\n",
      "glass\n",
      "cardboard\n",
      "cardboard\n",
      "plastic\n",
      "paper\n",
      "paper\n",
      "glass\n",
      "plastic\n",
      "metal\n",
      "glass\n",
      "glass\n",
      "glass\n",
      "glass\n",
      "glass\n",
      "glass\n",
      "cardboard\n",
      "paper\n",
      "cardboard\n",
      "metal\n",
      "metal\n",
      "plastic\n",
      "paper\n",
      "metal\n",
      "cardboard\n",
      "paper\n",
      "glass\n",
      "plastic\n",
      "plastic\n",
      "metal\n",
      "paper\n",
      "plastic\n",
      "cardboard\n",
      "paper\n",
      "glass\n",
      "paper\n",
      "paper\n",
      "glass\n",
      "metal\n",
      "paper\n",
      "metal\n",
      "metal\n",
      "glass\n",
      "cardboard\n",
      "cardboard\n",
      "plastic\n",
      "cardboard\n",
      "glass\n",
      "paper\n",
      "paper\n",
      "glass\n",
      "glass\n",
      "metal\n",
      "cardboard\n",
      "paper\n",
      "plastic\n",
      "paper\n",
      "paper\n",
      "metal\n",
      "cardboard\n",
      "glass\n",
      "glass\n",
      "glass\n",
      "plastic\n",
      "metal\n",
      "glass\n",
      "plastic\n",
      "paper\n",
      "plastic\n",
      "paper\n",
      "cardboard\n",
      "paper\n",
      "plastic\n",
      "plastic\n",
      "cardboard\n",
      "glass\n",
      "paper\n",
      "plastic\n",
      "metal\n",
      "paper\n",
      "glass\n",
      "glass\n",
      "paper\n",
      "glass\n",
      "cardboard\n",
      "glass\n",
      "cardboard\n",
      "plastic\n",
      "plastic\n",
      "cardboard\n",
      "paper\n",
      "metal\n",
      "cardboard\n",
      "cardboard\n",
      "cardboard\n",
      "paper\n",
      "glass\n",
      "cardboard\n",
      "cardboard\n",
      "plastic\n",
      "glass\n",
      "metal\n",
      "metal\n",
      "glass\n",
      "glass\n",
      "plastic\n",
      "metal\n",
      "cardboard\n",
      "plastic\n",
      "metal\n",
      "plastic\n",
      "cardboard\n",
      "metal\n",
      "paper\n",
      "glass\n",
      "paper\n",
      "paper\n",
      "paper\n",
      "glass\n",
      "plastic\n",
      "metal\n",
      "paper\n",
      "glass\n",
      "glass\n",
      "plastic\n",
      "paper\n",
      "plastic\n",
      "plastic\n",
      "paper\n",
      "glass\n",
      "glass\n",
      "paper\n",
      "glass\n",
      "paper\n",
      "paper\n",
      "glass\n",
      "paper\n",
      "plastic\n",
      "metal\n",
      "metal\n",
      "cardboard\n",
      "plastic\n",
      "metal\n",
      "paper\n",
      "paper\n",
      "metal\n",
      "paper\n",
      "plastic\n",
      "paper\n",
      "paper\n",
      "paper\n",
      "paper\n",
      "metal\n",
      "plastic\n",
      "paper\n",
      "paper\n",
      "paper\n",
      "paper\n",
      "glass\n",
      "plastic\n",
      "plastic\n",
      "metal\n",
      "paper\n",
      "metal\n",
      "plastic\n",
      "plastic\n",
      "paper\n",
      "glass\n",
      "glass\n",
      "plastic\n",
      "metal\n",
      "paper\n",
      "plastic\n",
      "paper\n",
      "plastic\n",
      "cardboard\n",
      "paper\n",
      "glass\n",
      "cardboard\n",
      "metal\n",
      "plastic\n",
      "paper\n",
      "paper\n",
      "glass\n",
      "glass\n",
      "paper\n",
      "metal\n",
      "cardboard\n",
      "cardboard\n",
      "plastic\n",
      "glass\n",
      "paper\n",
      "glass\n",
      "plastic\n",
      "cardboard\n",
      "plastic\n",
      "cardboard\n",
      "glass\n",
      "metal\n",
      "metal\n",
      "plastic\n",
      "cardboard\n",
      "glass\n",
      "paper\n",
      "glass\n",
      "paper\n",
      "plastic\n",
      "metal\n",
      "plastic\n",
      "paper\n",
      "cardboard\n",
      "glass\n",
      "paper\n",
      "plastic\n",
      "metal\n",
      "metal\n",
      "glass\n",
      "paper\n",
      "glass\n",
      "plastic\n",
      "paper\n",
      "metal\n",
      "paper\n",
      "glass\n",
      "paper\n",
      "plastic\n",
      "paper\n",
      "metal\n",
      "paper\n",
      "plastic\n",
      "paper\n",
      "paper\n",
      "paper\n",
      "metal\n",
      "plastic\n",
      "glass\n",
      "glass\n",
      "metal\n",
      "paper\n",
      "cardboard\n",
      "plastic\n",
      "cardboard\n",
      "glass\n",
      "glass\n",
      "cardboard\n",
      "glass\n",
      "metal\n",
      "paper\n",
      "glass\n",
      "paper\n",
      "cardboard\n",
      "glass\n",
      "cardboard\n",
      "plastic\n",
      "cardboard\n",
      "glass\n",
      "cardboard\n",
      "cardboard\n",
      "glass\n",
      "glass\n",
      "metal\n",
      "metal\n",
      "paper\n",
      "paper\n",
      "plastic\n",
      "cardboard\n",
      "paper\n",
      "metal\n",
      "paper\n",
      "cardboard\n",
      "paper\n",
      "metal\n",
      "paper\n",
      "paper\n",
      "plastic\n",
      "glass\n",
      "cardboard\n",
      "glass\n",
      "glass\n",
      "plastic\n",
      "cardboard\n"
     ]
    }
   ],
   "source": [
    "x_train, y_train, n = data.extract_all(dataset, x_train)\n",
    "# y_test = y_train\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.decomposition import PCA\n",
    "\n",
    "sklearn_pca = PCA(n_components=3)\n",
    "Y_sklearn = sklearn_pca.fit_transform(x_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "print(Y_sklearn[1])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "ename": "AttributeError",
     "evalue": "'module' object has no attribute 'imread'",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mAttributeError\u001b[0m                            Traceback (most recent call last)",
      "\u001b[0;32m<ipython-input-12-d6ab9120b8e2>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      3\u001b[0m \u001b[0max\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m[\u001b[0m\u001b[0max1\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0max2\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0max3\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      4\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 5\u001b[0;31m \u001b[0mm\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0mn\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mio\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mimread\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m'/Users/Tristan/Downloads/dog-breed-identification/datasets/test/cardboard66.jpg'\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mshape\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;36m0\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;36m2\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      6\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0mi\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mrange\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;36m0\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0msklearn_pca\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mget_params\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'n_components'\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      7\u001b[0m     \u001b[0max\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mi\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mimshow\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0msklearn_pca\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcomponents_\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mi\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mreshape\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mm\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0mn\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;31mAttributeError\u001b[0m: 'module' object has no attribute 'imread'"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<matplotlib.figure.Figure at 0x1062e5d10>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "fig, (ax1,ax2,ax3) = plt.subplots(3, figsize=(40, 20))\n",
    "\n",
    "ax = [ax1,ax2,ax3]\n",
    "\n",
    "m,n = io.imread('/Users/Tristan/Downloads/dog-breed-identification/datasets/test/cardboard66.jpg').shape[0:2]  \n",
    "for i in range(0,sklearn_pca.get_params()['n_components']):\n",
    "    ax[i].imshow(sklearn_pca.components_[i,:].reshape(m,n))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Testing data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "x_test, y_test, n = data.extract_all(dataset, x_test, dirname='test/' )\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Validation data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "x_validation, y_validation, n  = data.extract_all(dataset, x_validation, dirname='validation/')\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Convert labels and determine input and output shape for model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<module 'io' from '/anaconda2/lib/python2.7/io.pyc'>"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "imp.reload(io)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# y_train, y_test, y_validation = data.labels_to_vectors(dataset, y_train, y_test, y_validation)\n",
    "y_train = data.one_hot(y_train)\n",
    "y_test = data.one_hot(y_test)\n",
    "y_validation = data.one_hot(y_validation)\n",
    "input_shape = x_train.shape[1:] # = shape of an individual image (matrix)\n",
    "output_length = (y_train[0]).shape[0] # = length of an individual label\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "print(y_train)\n",
    "print(x_train)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Initiate VG16 network and add extra layers"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "from keras.models import Model \n",
    "\n",
    "def get_model(learn_rate=0.0001, batches=10, dropout=0.10):\n",
    "    # build the VGG16 network\n",
    "    model = applications.VGG16(weights='imagenet', include_top=False, input_shape = input_shape )\n",
    "    print('Model loaded.')\n",
    "\n",
    "    # build a classifier model to put on top of the convolutional model\n",
    "    # top_model = Sequential()\n",
    "    # top_model.add(Flatten(input_shape=model.output_shape[1:]))\n",
    "    # top_model.add(Dense(256, activation='relu'))\n",
    "    # top_model.add(Dropout(0.5))\n",
    "    # top_model.add(Dense(1, activation='sigmoid'))\n",
    "\n",
    "    for layer in model.layers:\n",
    "        layer.trainable = False\n",
    "\n",
    "    #Adding custom Layers \n",
    "    x = model.output\n",
    "    x = Flatten()(x)\n",
    "    x = (Dense(4096, activation='relu'))(x) #128\n",
    "    x = (Dropout(dropout))(x)\n",
    "    x = (Dense(2048, activation='relu'))(x) #128\n",
    "#     x = (Dense(16, activation='relu'))(x)\n",
    "    # softmax output to get probability distribution\n",
    "    predictions = Dense(output_length, activation=\"softmax\")(x)\n",
    "\n",
    "\n",
    "    # creating the final model \n",
    "    model_final = Model(input = model.input, output = predictions)\n",
    "\n",
    "    # Adam, SGD\n",
    "    # sgd = Keras.optimizers.SGD(lr=0.01, clipnorm=1.)\n",
    "    optimizer = optimizers.Adam(lr=learn_rate)\n",
    "\n",
    "    # compile the model \n",
    "    model_final.compile(loss = \"categorical_crossentropy\", optimizer = optimizer, metrics=['accuracy',\n",
    "        'mean_squared_error','categorical_crossentropy','top_k_categorical_accuracy'])\n",
    "    \n",
    "    return model_final"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Hyperparameter selection"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "from sklearn.grid_search import RandomizedSearchCV\n",
    "from keras.wrappers.scikit_learn import KerasClassifier\n",
    "import time\n",
    "\n",
    "# fix random seed for reproducibility\n",
    "seed = 7\n",
    "numpy.random.seed(seed)\n",
    "\n",
    "batches = [5, 10, 20]\n",
    "learn_rate = [0.0001, 0.001, 0.01]\n",
    "dropout = [0.1, 0.3, 0.5] # most used values\n",
    "param_grid = dict(learn_rate=learn_rate, batch_size=batches, dropout=dropout)\n",
    "\n",
    "# tune the hyperparameters via a randomized search\n",
    "model = KerasClassifier(build_fn=get_model, verbose=0)\n",
    "grid = RandomizedSearchCV(estimator=model, param_distributions=param_grid)\n",
    "start = time.time()\n",
    "grid.fit(x_validation, y_validation)\n",
    " \n",
    "# evaluate the best randomized searched model on the testing\n",
    "# data\n",
    "print(\"[INFO] randomized search took {:.2f} seconds\".format(\n",
    "    time.time() - start))\n",
    "acc = grid.score(x_validation, y_validation)\n",
    "print(\"[INFO] grid search accuracy: {:.2f}%\".format(acc * 100))\n",
    "print(\"[INFO] randomized search best parameters: {}\".format(\n",
    "    grid.best_params_))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "data augmentation"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Initiate the train and test generators with data Augumentation \n",
    "train_datagen = ImageDataGenerator(\n",
    "    rescale = 1./255,\n",
    "    horizontal_flip = True,\n",
    "    fill_mode = \"nearest\",\n",
    "    zoom_range = 0.3,\n",
    "    width_shift_range = 0.3,\n",
    "    height_shift_range=0.3,\n",
    "    rotation_range=30)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Train the model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# n epochs = n iterations over all the training data\n",
    "batch_size = 5\n",
    "epochs = 20"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### With data augmentation"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "model_final = get_model()\n",
    "\n",
    "train_datagen.fit(x_train)\n",
    "\n",
    "model_final.fit_generator(train_datagen.flow(x_train, y_train, batch_size=batch_size),\n",
    "                    steps_per_epoch=50, epochs=epochs, callbacks=[TensorBoard(log_dir=config.tmp_model_dir)])\n",
    "        \n",
    "model.save(config.dataset_dir + 'models/')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Without data augmentation"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "from keras.callbacks import TensorBoard\n",
    "model_final.fit(x_train, y_train, epochs=epochs, batch_size=batch_size,\n",
    "          validation_split=1/6, callbacks=[TensorBoard(log_dir=config.tmp_model_dir)])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "model_final = get_model()\n",
    "model_final.summary()\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### running tests\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "cvscores = []\n",
    "scores = model.evaluate(x_test, y_test, verbose=0)\n",
    "print(\"%s: %.2f%%\" % (model.metrics_names[1], scores[1]*100))\n",
    "cvscores.append(scores[1] * 100)\n",
    "print(\"%.2f%% (+/- %.2f%%)\" % (numpy.mean(cvscores), numpy.std(cvscores)))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Baseline"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "from pcanet import PCANet\n",
    "\n",
    "pcanet = PCANet(\n",
    "        image_shape= (512,348),\n",
    "        filter_shape_l1=2, step_shape_l1=1, n_l1_output=4,\n",
    "        filter_shape_l2=2, step_shape_l2=1, n_l2_output=4,\n",
    "        block_shape=2\n",
    "    )\n",
    "pcanet.validate_structure()\n",
    "\n",
    "pcanet.fit(x_train)\n",
    "X_train = pcanet.transform(x_train)\n",
    "X_test = pcanet.transform(x_test)\n",
    "\n",
    "model = RandomForestClassifier(n_estimators=100, random_state=1234, n_jobs=-1)\n",
    "model.fit(X_train, y_train)\n",
    "y_pred = model.predict(X_test)\n",
    "accuracy = accuracy_score(y_test, y_pred)\n",
    "print(\"accuracy: \" + str(accuracy))\n"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 2",
   "language": "python",
   "name": "python2"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 2
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython2",
   "version": "2.7.14"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
